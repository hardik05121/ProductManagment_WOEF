
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

CREATE PROCEDURE [dbo].[InquiryUpsert]    @Id int,	@Organization nchar(50),	@ContactPerson nchar(50),	@Email nchar(50),	@MobileNumber bigint,	@PhoneNumber bigint,	@Website nchar(50),	@Address nchar(50),	@Message nchar(450),	@CountryId int,	@StateId int,	@CityId int,	@UserId nvarchar(50),	@ProductId int,	@InquiryStatusId int,	@InquirySourceId intASBEGIN	SET NOCOUNT ON; IF @Id = 0    BEGIN         -- Check if the BrandName already exists        IF NOT EXISTS (SELECT * FROM Inquiries WHERE Organization = @Organization)        BEGIN            INSERT INTO Inquiries(Organization,ContactPerson,Email,MobileNumber,PhoneNumber,Website,Address,Message,CountryId,StateId,CityId,UserId,ProductId,InquiryStatusId,InquirySourceId)            VALUES(@Organization,@ContactPerson,@Email,@MobileNumber,@PhoneNumber,@Website,@Address,@Message,@CountryId,@StateId,@CityId,@UserId,@ProductId,@InquiryStatusId,@InquirySourceId)        END        ELSE        BEGIN            -- Handle the case when the BrandName already exists            RAISERROR('Inquiry with the same name already exists.', 16, 1);        END    END    ELSE    BEGIN        -- Check if the BrandName already exists for a different brand (when performing an update)        IF NOT EXISTS (SELECT * FROM Inquiries WHERE Organization = @Organization AND Id <> @Id)        BEGIN            UPDATE Inquiries            SET                Organization = @Organization,                ContactPerson = @ContactPerson,				Email = @Email,				MobileNumber = @MobileNumber,				PhoneNumber = @PhoneNumber,				Website = @Website,				Address = @Address,				Message = @Message,				CountryId = @CountryId,				StateId = @StateId,				CityId = @CityId,				UserId = @UserId,				ProductId = @ProductId,				InquiryStatusId = @InquiryStatusId,				InquirySourceId = @InquirySourceId            WHERE Id = @Id        END        ELSE        BEGIN            -- Handle the case when the BrandName already exists for a different brand            RAISERROR('Inquiry with the same name already exists for a different brand.', 16, 1);        END    ENDEND
